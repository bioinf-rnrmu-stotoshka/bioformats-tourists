![classes_bioformats](https://github.com/user-attachments/assets/20a1a0c0-59c6-4dc8-9ee0-7f81c8df831d)[![Review Assignment Due Date](https://classroom.github.com/assets/deadline-readme-button-22041afd0340ce965d47ae6ef1cefeee28c7c493a6346c4f15d667ab976d596c.svg)](https://classroom.github.com/a/I6I1ViQv)

<img width="205" height="201" alt="Снимок экрана 2025-10-20 в 03 49 06" src="https://github.com/user-attachments/assets/4eefb02e-b242-4530-a5f4-7951484aa94a" />
# bioformats

Учебный пакет для чтения и анализа **FASTA, FASTQ, SAM, VCF** c акцентом на работу с большими файлами (генераторы).
Проект включает CLI-утилиту `bioformats`, автотесты и Sphinx-документацию.

> **UML диаграмма классов**
> Вставь файл с диаграммой (например, `docs/uml.svg` или `images/uml.png`) вот сюда:
> `![UML diagram](docs/uml.svg)`
> *(см. раздел «Диаграмма классов (UML)» ниже для генерации и места хранения)*

---

## Возможности

* **FASTA/FASTQ**: количество записей, средняя длина; в FASTQ — извлечение Phred-качеств и средних значений.
* **FASTQ QC**: три графика — *per-base quality*, *per-base content*, *length distribution*.
* **SAM/VCF**: чтение заголовков, подсчёт записей, статистика по хромосомам, фильтрация по региону.
* Чтение ленивыми генераторами, поддержка больших файлов.

---

## Установка

Рекомендуется отдельное виртуальное окружение.

```bash
python -m venv .venv
source .venv/bin/activate       # Windows: .venv\Scripts\activate
python -m pip install -U pip
pip install -e .[dev]           # поставит пакет + pytest
```

Проверка:

```bash
python -c "import bioformats; print('bioformats', bioformats.__version__)"
bioformats --help
```

---

## Быстрый старт (CLI)

Данные для демо лежат в `sample_data/`.

### FASTA

```bash
bioformats fasta stats -i sample_data/example.fasta
```

### FASTQ (QC графики → папка reports/)

```bash
bioformats fastq qc -i sample_data/example.fastq -o reports
```

### SAM

```bash
bioformats sam chromstat -i sample_data/example.sam -o reports/sam_chrom.csv
bioformats sam slice -i sample_data/example.sam --chrom chr1 --start 100 --end 200
```

### VCF

```bash
bioformats vcf chromstat -i sample_data/example.vcf -o reports/vcf_chrom.csv
bioformats vcf slice -i sample_data/example.vcf --chrom chr1 --start 90 --end 150
```

---

## Использование как библиотеки

```python
from bioformats import FastaReader, FastqReader
from bioformats.sam import SamReader
from bioformats.vcf import VcfReader

with FastaReader("my.fasta") as r:
    print("N=", r.count(), "avg_len=", r.average_length())

fq = FastqReader("reads.fastq")
print(fq.get_average_quality("read_001"))

sam = SamReader("alignments.sam")
hits = list(sam.filter_by_region("chr1", 100_000, 101_000))

vcf = VcfReader("variants.vcf")
print("Variants:", vcf.count())
```

---

## Тесты

```bash
pytest -q
```

> Если запускаешь не из корня — убедись, что `pytest.ini` содержит:
>
> ```
> [pytest]
> pythonpath = src
> ```

---

## Документация (Sphinx)

Установить инструменты:

```bash
pip install -e .[docs]
```

Сборка HTML:

```bash
make -C docs html
# открыть: docs/build/html/index.html
```

Публикация на GitHub Pages: включить Pages в настройках репозитория и указывать ветку/папку с собранным HTML (например, `gh-pages`).

---

## Диаграмма классов (UML)
![Uploading classes<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 9.0.0 (0)
 -->
<!-- Title: classes_bioformats Pages: 1 -->
<svg width="1219pt" height="581pt"
 viewBox="0.00 0.00 1219.38 581.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 577)">
<title>classes_bioformats</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-577 1215.38,-577 1215.38,4 -4,4"/>
<!-- bioformats.fasta.FastaReader -->
<g id="node1" class="node">
<title>bioformats.fasta.FastaReader</title>
<polygon fill="none" stroke="black" points="0,-0.5 0,-115.5 420.25,-115.5 420.25,-0.5 0,-0.5"/>
<text text-anchor="start" x="176.75" y="-98.2" font-family="Times,serif" font-size="14.00">FastaReader</text>
<polyline fill="none" stroke="black" points="0,-91 420.25,-91"/>
<polyline fill="none" stroke="black" points="0,-91 420.25,-91"/>
<text text-anchor="start" x="8" y="-73.7" font-family="Times,serif" font-size="14.00">filter_sequences(min_length: int, max_length: int): Iterator[SequencePair]</text>
<text text-anchor="start" x="8" y="-57.2" font-family="Times,serif" font-size="14.00">get_sequence_by_index(index: int): Tuple[str, str]</text>
<text text-anchor="start" x="8" y="-40.7" font-family="Times,serif" font-size="14.00">read(): Iterator[SequencePair]</text>
<text text-anchor="start" x="8" y="-24.2" font-family="Times,serif" font-size="14.00">read_sequences(): Iterator[Tuple[str, str]]</text>
<text text-anchor="start" x="8" y="-7.7" font-family="Times,serif" font-size="14.00">to_dict(): dict</text>
</g>
<!-- bioformats.sequences.SequenceReader -->
<g id="node6" class="node">
<title>bioformats.sequences.SequenceReader</title>
<polygon fill="none" stroke="black" points="423.12,-161.25 423.12,-288.25 649.12,-288.25 649.12,-161.25 423.12,-161.25"/>
<text text-anchor="start" x="491.12" y="-270.95" font-family="Times,serif" font-size="14.00">SequenceReader</text>
<polyline fill="none" stroke="black" points="423.12,-263.75 649.12,-263.75"/>
<text text-anchor="start" x="500.12" y="-246.45" font-family="Times,serif" font-size="14.00">alphabet : set</text>
<polyline fill="none" stroke="black" points="423.12,-239.25 649.12,-239.25"/>
<text text-anchor="start" x="431.12" y="-222.95" font-family="Times,serif" font-size="14.00">average_length(): float</text>
<text text-anchor="start" x="431.12" y="-208.95" font-family="Times,serif" font-size="14.00">count(): int</text>
<text text-anchor="start" x="431.12" y="-194.95" font-family="Times,serif" font-size="14.00">get_sequence(seq_id: str): str</text>
<text text-anchor="start" x="431.12" y="-180.95" font-family="Times,serif" font-style="italic" font-size="14.00">read</text>
<text text-anchor="start" x="455.88" y="-180.95" font-family="Times,serif" font-size="14.00">(): Iterator[SequencePair]</text>
<text text-anchor="start" x="431.12" y="-166.95" font-family="Times,serif" font-size="14.00">validate_sequence(sequence: str): bool</text>
</g>
<!-- bioformats.fasta.FastaReader&#45;&gt;bioformats.sequences.SequenceReader -->
<g id="edge1" class="edge">
<title>bioformats.fasta.FastaReader&#45;&gt;bioformats.sequences.SequenceReader</title>
<path fill="none" stroke="black" d="M322.77,-115.93C351.79,-130.59 383.17,-146.45 412.71,-161.38"/>
<polygon fill="none" stroke="black" points="410.79,-164.33 421.29,-165.72 413.95,-158.08 410.79,-164.33"/>
</g>
<!-- bioformats.fastq.FastqReader -->
<g id="node2" class="node">
<title>bioformats.fastq.FastqReader</title>
<polygon fill="none" stroke="black" points="438,-17 438,-99 672.25,-99 672.25,-17 438,-17"/>
<text text-anchor="start" x="521.38" y="-81.7" font-family="Times,serif" font-size="14.00">FastqReader</text>
<polyline fill="none" stroke="black" points="438,-74.5 672.25,-74.5"/>
<polyline fill="none" stroke="black" points="438,-74.5 672.25,-74.5"/>
<text text-anchor="start" x="446" y="-57.2" font-family="Times,serif" font-size="14.00">get_average_quality(seq_id: str): float</text>
<text text-anchor="start" x="446" y="-40.7" font-family="Times,serif" font-size="14.00">get_quality_scores(seq_id: str): List[int]</text>
<text text-anchor="start" x="446" y="-24.2" font-family="Times,serif" font-size="14.00">read(): Iterator[SequencePair]</text>
</g>
<!-- bioformats.fastq.FastqReader&#45;&gt;bioformats.sequences.SequenceReader -->
<g id="edge2" class="edge">
<title>bioformats.fastq.FastqReader&#45;&gt;bioformats.sequences.SequenceReader</title>
<path fill="none" stroke="black" d="M550.48,-99.3C548.73,-114.46 546.68,-132.22 544.69,-149.5"/>
<polygon fill="none" stroke="black" points="541.23,-148.91 543.56,-159.25 548.19,-149.71 541.23,-148.91"/>
</g>
<!-- bioformats.genomic.GenomicDataReader -->
<g id="node3" class="node">
<title>bioformats.genomic.GenomicDataReader</title>
<polygon fill="none" stroke="black" points="666.75,-152.5 666.75,-297 1067.5,-297 1067.5,-152.5 666.75,-152.5"/>
<text text-anchor="start" x="810.12" y="-279.7" font-family="Times,serif" font-size="14.00">GenomicDataReader</text>
<polyline fill="none" stroke="black" points="666.75,-272.5 1067.5,-272.5"/>
<polyline fill="none" stroke="black" points="666.75,-272.5 1067.5,-272.5"/>
<text text-anchor="start" x="674.75" y="-256.2" font-family="Times,serif" font-size="14.00">count(): int</text>
<text text-anchor="start" x="674.75" y="-242.2" font-family="Times,serif" font-size="14.00">filter_by_region(chrom: str, start: int, end: int): Iterator[Dict[str, Any]]</text>
<text text-anchor="start" x="674.75" y="-228.2" font-family="Times,serif" font-size="14.00">get_chromosomes(): list[str]</text>
<text text-anchor="start" x="674.75" y="-214.2" font-family="Times,serif" font-style="italic" font-size="14.00">get_header</text>
<text text-anchor="start" x="735.5" y="-214.2" font-family="Times,serif" font-size="14.00">(): list[str]</text>
<text text-anchor="start" x="674.75" y="-200.2" font-family="Times,serif" font-size="14.00">get_reference_genome(): Optional[str]</text>
<text text-anchor="start" x="674.75" y="-186.2" font-family="Times,serif" font-style="italic" font-size="14.00">read</text>
<text text-anchor="start" x="699.5" y="-186.2" font-family="Times,serif" font-size="14.00">(): Iterator[Dict[str, Any]]</text>
<text text-anchor="start" x="674.75" y="-172.2" font-family="Times,serif" font-size="14.00">to_dataframe(limit: Optional[int]): pd.DataFrame</text>
<text text-anchor="start" x="674.75" y="-158.2" font-family="Times,serif" font-size="14.00">validate_coordinate(chrom: str, pos: int): bool</text>
</g>
<!-- bioformats.reader.Reader -->
<g id="node4" class="node">
<title>bioformats.reader.Reader</title>
<polygon fill="none" stroke="black" points="490.62,-334 490.62,-572.5 911.62,-572.5 911.62,-334 490.62,-334"/>
<text text-anchor="start" x="682" y="-555.2" font-family="Times,serif" font-size="14.00">Reader</text>
<polyline fill="none" stroke="black" points="490.62,-548 911.62,-548"/>
<text text-anchor="start" x="664" y="-530.7" font-family="Times,serif" font-size="14.00">encoding : str</text>
<text text-anchor="start" x="664" y="-514.2" font-family="Times,serif" font-size="14.00">filename : str</text>
<polyline fill="none" stroke="black" points="490.62,-507 911.62,-507"/>
<text text-anchor="start" x="498.62" y="-489.7" font-family="Times,serif" font-size="14.00">close(): None</text>
<text text-anchor="start" x="498.62" y="-473.2" font-family="Times,serif" font-size="14.00">iter_chunked(size: int): Iterator[str]</text>
<text text-anchor="start" x="498.62" y="-456.7" font-family="Times,serif" font-size="14.00">iter_lines(strip: bool): Iterator[str]</text>
<text text-anchor="start" x="498.62" y="-440.2" font-family="Times,serif" font-size="14.00">iter_until(stop_pred: Callable[[str], bool], include_stop: bool): Iterator[str]</text>
<text text-anchor="start" x="498.62" y="-423.7" font-family="Times,serif" font-size="14.00">open(): None</text>
<text text-anchor="start" x="498.62" y="-407.2" font-family="Times,serif" font-size="14.00">peek_line(): Optional[str]</text>
<text text-anchor="start" x="498.62" y="-390.7" font-family="Times,serif" font-size="14.00">raw()</text>
<text text-anchor="start" x="498.62" y="-374.2" font-family="Times,serif" font-size="14.00">seek(pos: int, whence: int): None</text>
<text text-anchor="start" x="498.62" y="-357.7" font-family="Times,serif" font-size="14.00">skip_while(pred: Callable[[str], bool]): None</text>
<text text-anchor="start" x="498.62" y="-341.2" font-family="Times,serif" font-size="14.00">tell(): int</text>
</g>
<!-- bioformats.genomic.GenomicDataReader&#45;&gt;bioformats.reader.Reader -->
<g id="edge3" class="edge">
<title>bioformats.genomic.GenomicDataReader&#45;&gt;bioformats.reader.Reader</title>
<path fill="none" stroke="black" d="M814.6,-297.42C808.12,-306.26 801.36,-315.49 794.5,-324.85"/>
<polygon fill="none" stroke="black" points="791.88,-322.5 788.79,-332.64 797.52,-326.64 791.88,-322.5"/>
</g>
<!-- bioformats.sam.SamReader -->
<g id="node5" class="node">
<title>bioformats.sam.SamReader</title>
<polygon fill="none" stroke="black" points="727.25,-17 727.25,-99 969,-99 969,-17 727.25,-17"/>
<text text-anchor="start" x="816.62" y="-81.7" font-family="Times,serif" font-size="14.00">SamReader</text>
<polyline fill="none" stroke="black" points="727.25,-74.5 969,-74.5"/>
<polyline fill="none" stroke="black" points="727.25,-74.5 969,-74.5"/>
<text text-anchor="start" x="735.25" y="-57.2" font-family="Times,serif" font-size="14.00">get_alignment_statistics(): pd.DataFrame</text>
<text text-anchor="start" x="735.25" y="-40.7" font-family="Times,serif" font-size="14.00">get_header(): list[str]</text>
<text text-anchor="start" x="735.25" y="-24.2" font-family="Times,serif" font-size="14.00">read(): Iterator[Dict[str, Any]]</text>
</g>
<!-- bioformats.sam.SamReader&#45;&gt;bioformats.genomic.GenomicDataReader -->
<g id="edge4" class="edge">
<title>bioformats.sam.SamReader&#45;&gt;bioformats.genomic.GenomicDataReader</title>
<path fill="none" stroke="black" d="M852.77,-99.3C854.23,-111.98 855.91,-126.47 857.58,-140.98"/>
<polygon fill="none" stroke="black" points="854.06,-141.02 858.68,-150.55 861.01,-140.22 854.06,-141.02"/>
</g>
<!-- bioformats.sequences.SequenceReader&#45;&gt;bioformats.reader.Reader -->
<g id="edge5" class="edge">
<title>bioformats.sequences.SequenceReader&#45;&gt;bioformats.reader.Reader</title>
<path fill="none" stroke="black" d="M581.87,-288.54C590.16,-299.92 599.07,-312.15 608.15,-324.62"/>
<polygon fill="none" stroke="black" points="605.18,-326.49 613.9,-332.51 610.84,-322.37 605.18,-326.49"/>
</g>
<!-- bioformats.vcf.VcfReader -->
<g id="node7" class="node">
<title>bioformats.vcf.VcfReader</title>
<polygon fill="none" stroke="black" points="986.88,-17 986.88,-99 1211.38,-99 1211.38,-17 986.88,-17"/>
<text text-anchor="start" x="1069.88" y="-81.7" font-family="Times,serif" font-size="14.00">VcfReader</text>
<polyline fill="none" stroke="black" points="986.88,-74.5 1211.38,-74.5"/>
<polyline fill="none" stroke="black" points="986.88,-74.5 1211.38,-74.5"/>
<text text-anchor="start" x="994.88" y="-57.2" font-family="Times,serif" font-size="14.00">get_header(): list[str]</text>
<text text-anchor="start" x="994.88" y="-40.7" font-family="Times,serif" font-size="14.00">get_variant_statistics(): pd.DataFrame</text>
<text text-anchor="start" x="994.88" y="-24.2" font-family="Times,serif" font-size="14.00">read(): Iterator[Dict[str, Any]]</text>
</g>
<!-- bioformats.vcf.VcfReader&#45;&gt;bioformats.genomic.GenomicDataReader -->
<g id="edge6" class="edge">
<title>bioformats.vcf.VcfReader&#45;&gt;bioformats.genomic.GenomicDataReader</title>
<path fill="none" stroke="black" d="M1042.37,-99.3C1022.68,-113.28 999.88,-129.48 977.37,-145.46"/>
<polygon fill="none" stroke="black" points="975.45,-142.53 969.32,-151.18 979.5,-148.24 975.45,-142.53"/>
</g>
</g>
</svg>
_bioformats.svg…]()


## Структура проекта

```
bioformats-tourists/
├── README.md
├── pyproject.toml
├── pytest.ini
├── src/bioformats/
│   ├── __init__.py
│   ├── reader.py
│   ├── sequences.py
│   ├── genomic.py
│   ├── fasta.py
│   ├── fastq.py
│   ├── sam.py
│   ├── vcf.py
│   └── cli.py
├── tests/
│   ├── test_fasta.py
│   ├── test_fastq.py
│   ├── test_sam.py
│   └── test_vcf.py
├── sample_data/
│   ├── example.fasta
│   ├── example.fastq
│   ├── example.sam
│   └── example.vcf
└── docs/                      # Sphinx
    └── ...
```

---

## Лицензия

MIT (см. `LICENSE`).

---

## Благодарности

Команда **bioformats-tourists**. Спасибо за примеры данных NCBI/UniProt.

---

<img width="203" height="199" alt="Снимок экрана 2025-10-20 в 03 55 29" src="https://github.com/user-attachments/assets/1245a9ec-adeb-4433-a946-a6459b1d09f0" />


<img width="203" height="199" alt="Снимок экрана 2025-10-20 в 03 57 02" src="https://github.com/user-attachments/assets/9f85c26d-491d-4a03-bf95-d98353cb3bd4" />
<img width="203" height="199" alt="Снимок экрана 2025-10-20 в 03 57 16" src="https://github.com/user-attachments/assets/7149c201-0dd6-4d7c-be98-a7678f91fc84" />

<img width="201" height="191" alt="Снимок экрана 2025-10-20 в 03 57 45" src="https://github.com/user-attachments/assets/7ca73840-0cb8-4316-82ac-2b3f34e58f4a" />

<img width="201" height="191" alt="Снимок экрана 2025-10-20 в 03 59 11" src="https://github.com/user-attachments/assets/35ea3087-9927-4b28-b320-701e9ca2a185" />
